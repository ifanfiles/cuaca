<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Pivot Prakiraan Cuaca</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; font-size: 14px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #eee; }
    .kab { text-align: left; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Prakiraan Cuaca Per Kabupaten</h2>
  <div id="pivot"></div>

  <script>
    async function loadData() {
      const res = await fetch("prakiraan_kabupaten_full3jam.json"); // ganti path sesuai lokasi file
      const data = await res.json();

      // --- Ambil semua waktu unik, urutkan ---
      let allTimes = new Set();
      for (const kab in data) {
        Object.keys(data[kab]).forEach(t => allTimes.add(t));
      }
      const times = Array.from(allTimes).sort((a,b)=> {
        return new Date(a) - new Date(b);
      });

      // --- Buat tabel ---
      let html = "<table><tr><th>Kabupaten</th>";
      times.forEach(t => { html += `<th>${t}</th>`; });
      html += "</tr>";

      for (const kab in data) {
        html += `<tr><td class="kab">${kab}</td>`;
        times.forEach(t => {
          let val = data[kab][t] ? data[kab][t].cuaca : "-";
          html += `<td>${val}</td>`;
        });
        html += "</tr>`;
      }

      html += "</table>";
      document.getElementById("pivot").innerHTML = html;
    }

    loadData();
  </script>
</body>
</html>
